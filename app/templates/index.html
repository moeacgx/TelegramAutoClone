<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ app_name }}</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <header>
    <h1>Telegram 自动克隆系统（多任务组）</h1>
    <p>无引用克隆 / 备用频道池 / 封禁恢复队列</p>
  </header>

  <main>
    <section class="card">
      <h2>登录状态</h2>
      <div class="row">
        <label>
          <input id="auto-polling-toggle" type="checkbox" checked />
          静默轮询(10秒)
        </label>
      </div>
      <pre id="auth-status">加载中...</pre>
      <div class="row">
        <input id="phone" placeholder="手机号(例如 +8613800000000)" />
        <button id="send-code-btn">发送验证码</button>
      </div>
      <div class="row">
        <input id="code" placeholder="验证码" />
        <input id="password" placeholder="二步验证密码(可选)" />
        <button id="login-btn">手机号登录</button>
      </div>
      <div class="row">
        <button id="create-qr-btn">生成扫码登录二维码</button>
        <button id="poll-qr-btn">检查扫码状态(可选)</button>
        <button id="qr-password-login-btn">扫码后提交二级密码</button>
      </div>
      <div class="qr-wrap">
        <img id="qr-image" alt="二维码" />
      </div>
      <div id="qr-status" class="hint"></div>
    </section>

    <section class="card">
      <h2>超级群任务组</h2>
      <div class="row">
        <input id="source-chat-ref" placeholder="输入超级群ID/@username/t.me链接" />
        <button id="add-source-btn">添加任务组</button>
      </div>
      <ul id="source-group-list"></ul>
    </section>

    <section class="card">
      <h2>系统更新</h2>
      <div class="row">
        <button id="check-update-btn">检查更新</button>
        <button id="confirm-update-btn">确认并更新</button>
      </div>
      <pre id="update-status">加载中...</pre>
    </section>

    <section class="card">
      <h2>话题工作列表</h2>
      <p>当前任务组ID: <span id="current-source-id">未选择</span></p>
      <div class="row">
        <button id="sync-topics-btn">同步当前任务组话题</button>
      </div>
      <table>
        <thead>
          <tr>
            <th>topic_id</th>
            <th>标题</th>
            <th>启用</th>
            <th>绑定频道</th>
          </tr>
        </thead>
        <tbody id="topics-body"></tbody>
      </table>
    </section>

    <section class="card">
      <h2>备用频道池</h2>
      <div class="row">
        <button id="refresh-standby-btn">刷新备用频道池</button>
        <button id="delete-selected-standby-btn">删除选中</button>
        <button id="clear-standby-btn">清空备用池</button>
      </div>
      <p class="hint">已选中: <span id="standby-selected-count">0</span></p>
      <div class="row">
        <textarea
          id="standby-batch-input"
          rows="6"
          style="width: 100%;"
          placeholder="批量添加备用频道：一行一个\n支持 -100xxxx / @username / t.me 链接 / 频道消息URL"
        ></textarea>
      </div>
      <div class="row">
        <button id="add-standby-batch-btn">批量添加备用频道</button>
      </div>
      <ul id="standby-list"></ul>
    </section>

    <section class="card">
      <h2>绑定列表</h2>
      <ul id="binding-list"></ul>
    </section>

    <section class="card">
      <h2>封禁频道列表</h2>
      <div class="row">
        <button id="clear-banned-btn">清空封禁列表</button>
      </div>
      <ul id="banned-list"></ul>
    </section>

    <section class="card">
      <h2>恢复队列</h2>
      <div class="row">
        <button id="run-monitor-btn">手动巡检一次</button>
        <button id="run-recovery-btn">手动执行一个恢复任务</button>
        <button id="reset-running-queue-btn">重置运行中任务</button>
        <button id="clear-recovery-queue-btn">清空任务</button>
      </div>
      <p class="hint">任务支持继续执行(断点) / 重新执行(从头)</p>
      <ul id="queue-list"></ul>
    </section>
  </main>

  <script src="/static/app.js"></script>
</body>
</html>
